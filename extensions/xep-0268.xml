<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE xep SYSTEM 'xep.dtd' [
  <!ENTITY % ents SYSTEM 'xep.ent'>
%ents;
]>
<?xml-stylesheet type='text/xsl' href='xep.xsl'?>
<xep>
<header>
  <title>Incident Handling</title>
  <abstract>This specification defines methods for incident reporting among XMPP server deployments using the IODEF format produced by the IETF's INCH Working Group.</abstract>
  &LEGALNOTICE;
  <number>0268</number>
  <status>Experimental</status>
  <type>Standards Track</type>
  <sig>Standards</sig>
  <approver>Council</approver>
  <dependencies>
    <spec>XMPP Core</spec>
  </dependencies>
  <supersedes/>
  <supersededby/>
  <shortname>NOT_YET_ASSIGNED</shortname>
  <discuss>operators</discuss>
  <author>
    <firstname>Artur</firstname>
    <surname>Hefczyc</surname>
    <email>artur.hefczyc@gmail.com</email>
    <jid>artur.hefczyc@tigase.org</jid>
  </author>
  <author>
    <firstname>Florian</firstname>
    <surname>Jensen</surname>
    <email>admin@flosoft.biz</email>
    <jid>admin@im.flosoft.biz</jid>
  </author>
  <author>
    <firstname>Mickaël</firstname>
    <surname>Rémond</surname>
    <email>mickael.remond@process-one.net</email>
    <jid>mremond@process-one.net</jid>
  </author>
  &stpeter;
  &mwild;
  <revision>
    <version>0.4</version>
    <date>2012-04-17</date>
    <initials>psa</initials>
    <remark><p>Changed the XML format from a custom schema to IODEF (RFC 5070); incremented namespace version from 1 to 2.</p></remark>
  </revision>
  <revision>
    <version>0.3</version>
    <date>2009-11-17</date>
    <initials>psa</initials>
    <remark><p>Added security considerations; defined schema.</p></remark>
  </revision>
  <revision>
    <version>0.2</version>
    <date>2009-06-05</date>
    <initials>mw/psa</initials>
    <remark><p>Added more detailed information about the solution element; removed the suggestion element since the solution element can be used by both reporting entities and receiving entities; added notes about processing of incident reports by receiving entities.</p></remark>
  </revision>
  <revision>
    <version>0.1</version>
    <date>2009-04-30</date>
    <initials>psa</initials>
    <remark><p>Initial published version.</p></remark>
  </revision>
  <revision>
    <version>0.0.3</version>
    <date>2009-04-30</date>
    <initials>psa</initials>
    <remark><p>Per Council feedback, moved server rosters to a separate specification.</p></remark>
  </revision>
  <revision>
    <version>0.0.2</version>
    <date>2009-04-27</date>
    <initials>psa/fj</initials>
    <remark><p>Refactored XML format; added elements for sub-categories, locations, related incidents, solutions, and suggestions.</p></remark>
  </revision>
  <revision>
    <version>0.0.1</version>
    <date>2009-04-13</date>
    <initials>ah/fj/psa/mr/mw</initials>
    <remark><p>First draft.</p></remark>
  </revision>
</header>

<section1 topic='Introduction' anchor='intro'>
  <p>As XMPP technologies have been deployed more widely, the open XMPP network has become a more significant target for attacks. This specification defines ways for XMPP server deployments to share information with each other and therefore to handle such attacks in a more real-time fashion. In particular, it defines a way to use the IODEF format (defined in &rfc5070; and produced by the IETF's INCH Working Group) as the basis for sharing incident reports among XMPP server deployments. (For some related considerations, see &rfc2350; and &rfc3067;.)</p>
</section1>

<section1 topic='Interactions' anchor='interactions'>
  <p>This document defines several interactions (similar to those in &rfc6045;) between XMPP server deployments with respect to incident handling. These interactions are transported using the XMPP &IQ; stanza as described below.</p>
  <ol>
    <li><p>The &lt;report/&gt; element (contained in an &IQ; stanza of type "set" or, in response to an &lt;inquiry/&gt; element, of type "result") describes the nature of an incident and also flags the 'status' of the incident as "new", "updated", or "resolved"; it is sent from one server to another for informative purposes (sometimes in reply to the &lt;inquiry/&gt; element) but without requesting assistance (for which see the &lt;request/&gt; element).</p></li>
    <li><p>The &lt;inquiry/&gt; element (contained in an &IQ; stanza of type "get") asks for information about an incident; it is expected that the reply will contain a &lt;report/&gt; element.</p></li>
    <li><p>The &lt;request/&gt; element (contained in an &IQ; stanza of type "get") asks for assistance in resolving an incident.</p></li>
    <li><p>The &lt;response/&gt; element (contained in an &IQ; stanza of type "result") provides assistance in resolving an incident.</p></li>
  </ol>
</section1>

<section1 topic='Report Format and Processing' anchor='report'>
  <p>An incident report consists of an XMPP &IQ; stanza of type "set" or "result" containing an IODEF document. An example is shown below.</p>
  <example caption="An incident report"><![CDATA[
<iq from='jabber.org' id='vk2x91g47 to='im.flosoft.biz' type='set'>
  <Incident xmlns='urn:ietf:params:xml:ns:iodef-1.0'
            purpose='reporting'>
    <IncidentID name='jabber.org'>4BF5D2CE-7C90-4860-BEF2-43A7D777D5FF</IncidentID>
    <StartTime>2009-04-13T19:05:20Z</StartTime>
    <EndTime>2009-04-13T19:27:22Z</EndTime>
    <ReportTime>2009-04-13T19:31:07Z</ReportTime>
    <Description xml:lang='en'>lots of MUC spammers from abuse.lit!</Description>
    <Contact role='admin' type='person'>
      <AdditionalData>
        <jid xmlns='urn:xmpp:incident:2'>stpeter@jabber.org</jid>
      </AdditionalData>
    </Contact>
    <Contact role='admin' type='person'>
      <AdditionalData>
        <jid xmlns='urn:xmpp:incident:2'>stpeter@jabber.org</jid>
      </AdditionalData>
    </Contact>
    <Contact role='ext-type' ext-type='chatroom'>
      <AdditionalData>
        <jid xmlns='urn:xmpp:incident:2'>operators@muc.xmpp.org</jid>
      </AdditionalData>
    </Contact>
    <RelatedActivity>
      <IncidentID name='im.example.com'>133BCE2E-E669-4ECE-B0F8-766B9E65630D</IncidentID>
    </RelatedActivity>
    <Assessment>
      <Impact lang='en' severity='medium' completion='succeeded' type='dos'/>
    </Assessment>
    <EventData>
      <Flow>
        <System category='source'>
          <Node>
            <Address category='ext-category' ext-category='xmpp'>abuser@abuse.lit</Address>
            <Counter type='ext-type' ext-type='xmpp-presence'>123</Counter>
          </Node>
          <Node>
            <Address category='ext-category' ext-category='xmpp'>luser27@abuse.lit</Address>
            <Counter type='ext-type' ext-type='xmpp-presence'>47</Counter>
          </Node>
        </System>
        <System category='target'>
          <Node>
            <Address category='ext-category' ext-category='xmpp'>jdev@conference.jabber.org</Address>
            <Address category='ext-category' ext-category='xmpp'>jabber@conference.jabber.org</Address>
            <NodeRole category='ext-category' ext-category='xmpp-muc'/>
          </Node>
        </System>
      </Flow>
      <info>
        <category>muc</category>
        <type>presence</type>
        <type>long-messages</type>
  </Incident>
</iq>
  ]]></example>
  <p>If the report is contained in an &IQ; stanza of type "set" and the recipient of the report is able to process it, it MUST return an &IQ; stanza of type "result". Error handling will be defined in a future version of this specification.</p>
</section1>

<section1 topic='Inquiry Format and Processing' anchor='inquiry'>
  <p>To follow.</p>
</section1>

<section1 topic='Request Format and Processing' anchor='request'>
  <p>To follow.</p>
</section1>

<section1 topic='Response Format and Processing' anchor='response'>
  <p>To follow.</p>
</section1>

<section1 topic='Internationalization Considerations' anchor='i18n'>
  <p>The &lt;jid/&gt; element qualified by the 'urn:xmpp:incident:2' namespace is a "JID slot" as described in &rfc6122bis;.</p>
</section1>

<section1 topic='Security Considerations' anchor='security'>
  <p>It is RECOMMENDED for a server deployment to exchange incident reports only with peer servers that it trusts, for example peers that are in its "server roster" as described in &xep0267;.</p>
  <p>This technology is designed to help mitigate attacks on the XMPP network. However, incident reporting is itself vulnerable to the following attacks:</p>
  <ul>
    <li>False reports could lead a server to deny service to legitimate users or peer servers (see also &xep0205;). To help mitigate such attacks, a server SHOULD treat with caution any incident reports that it might receive from untrusted entities.</li>
    <li>If traffic between two servers is not protected using Transport Layer Security (TLS), a passive eavesdropper could gain access to incident reports and therefore adjust its behavior in response. To prevent such attacks, servers SHOULD use TLS.</li>
  </ul>
  <p>Use of the XMPP channel is convenient for communication among XMPP servers; however, if a denial of service attack is severe enough then that channel itself might be unusable.</p>
  <p>Unless explicitly configured to do so, a receiving server SHOULD NOT automatically modify its configuration based on receipt of an incident report, even from a trusted server, but instead SHOULD prompt the human administrators so that they can take appropriate action.</p>
  <p>A receiving server MAY accept incident reports from peers that are not on its "trust list", but SHOULD treat such reports with caution and provide them to the human administrator(s) of the server.</p>
  <p>A receiving server MAY forward reports that it receives to other servers it trusts.</p>
</section1>

<section1 topic='IANA Considerations' anchor='iana'>
  <p>This document might require interaction with &IANA; to register various IODEF extension attributes.</p> 
</section1>

<section1 topic='XMPP Registrar Considerations' anchor='reg'>
  <section2 topic='Protocol Namespaces' anchor='registrar-ns'>
    <p>This specification defines the following XML namespace:</p>
    <ul>
      <li>urn:xmpp:incident:2</li>
    </ul>
    <p>Upon advancement of this specification from a status of Experimental to a status of Draft, the &REGISTRAR; shall add the foregoing namespace to the registry located at &NAMESPACES;, as described in Section 4 of &xep0053;.</p>
  </section2>
  <section2 topic='Protocol Versioning' anchor='registrar-versioning'>
    &NSVER;
  </section2>
</section1>

<section1 topic='XML Schema' anchor='schema'>
  <code><![CDATA[
<?xml version='1.0' encoding='UTF-8'?>

<xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:incident:2'
    xmlns='urn:xmpp:incident:2'
    elementFormDefault='qualified'>

  <xs:element name='jid' type='xs:string'/>

</xs:schema>
  ]]></code>
</section1>

</xep>
